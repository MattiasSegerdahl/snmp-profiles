# https://circitor.fr/Mibs/Html/IB-SMI-MIB.php
# https://circitor.fr/Mibs/Html/IB-PLATFORMONE-MIB.php
# https://circitor.fr/Mibs/Html/IB-DHCPONE-MIB.php
# https://circitor.fr/Mibs/Html/IB-DNSONE-MIB.php
# https://mibs.observium.org/mib/IB-DHCPONE-MIB/
# https://mibs.observium.org/mib/IB-DNSONE-MIB/
#
# This profile includes comprehensive Infoblox MIB support based on actual device capabilities:
#
# IB-PLATFORMONE-MIB:
# - System Status and Performance metrics
# - Service Status Counters (5 different counter types)
#
# IB-DHCPONE-MIB:
# - DHCP Subnet Table with percentage usage (OID .1.3.6.1.4.1.7779.3.1.1.4.1.1.1.3)
# - DHCP Statistics counters (Discovers, Requests, Releases, Offers, ACKs, NACKs, Declines, Informs, Others)
# - DHCP Extended Statistics (10 additional counter types)
# - DHCP Performance Statistics (4 Counter64 and 4 Gauge32 metrics)
# - DHCP DDNS Statistics (Average latency and timeout counts for 5min, 15min, 60min, 1440min intervals)
# - DHCP Deferred Queue Size
#
# IB-DNSONE-MIB:
# - Zone Statistics Table (Success, Referral, NXRRset, NXDomain, Recursion, Failure)
# - Zone Plus View Statistics Table (per-zone and per-view statistics)
# - DDNS Update Statistics (Success, Failure, Reject, Prerequisite Reject)
# - Zone Transfer Count Statistics
# - DNS Query Rate
---
extends:
  - if-mib.yml
  - system-mib.yml
  - host-resources-mib.yml
  - ucd-mib.yml

provider: kentik-ipam

sysobjectid:
  - 1.3.6.1.4.1.7779.1.1004    # Virtual Device
  - 1.3.6.1.4.1.7779.1.1204    # IB-1552
  - 1.3.6.1.4.1.7779.1.1301    # IB-550-A
  - 1.3.6.1.4.1.7779.1.1302    # IB-1050-A
  - 1.3.6.1.4.1.7779.1.1303    # IB-1550-A
  - 1.3.6.1.4.1.7779.1.1401    # IB-810
  - 1.3.6.1.4.1.7779.1.1402    # IB-820
  - 1.3.6.1.4.1.7779.1.1403    # IB-1410
  - 1.3.6.1.4.1.7779.1.1404    # IB-1420
  - 1.3.6.1.4.1.7779.1.1405    # IB-1400
  - 1.3.6.1.4.1.7779.1.1406    # IB-800
  - 1.3.6.1.4.1.7779.1.1407    # PT-1400
  - 1.3.6.1.4.1.7779.1.1411    # IB-2200
  - 1.3.6.1.4.1.7779.1.1412    # IB-2210
  - 1.3.6.1.4.1.7779.1.1413    # IB-2220
  - 1.3.6.1.4.1.7779.1.1414    # PT-2200
  - 1.3.6.1.4.1.7779.1.1421    # IB-4010
  - 1.3.6.1.4.1.7779.1.1422    # IB-4030
  - 1.3.6.1.4.1.7779.1.1423    # IB-4000
  - 1.3.6.1.4.1.7779.1.1424    # PT-4000
  - 1.3.6.1.4.1.7779.1.1425    # Infoblox, Model Unknown
  - 1.3.6.1.4.1.7779.1.1431    # IB-100
  - 1.3.6.1.4.1.7779.1.1441    # ND-800
  - 1.3.6.1.4.1.7779.1.1442    # ND-1400
  - 1.3.6.1.4.1.7779.1.1443    # ND-2200
  - 1.3.6.1.4.1.7779.1.1444    # ND-4000
  - 1.3.6.1.4.1.7779.1.1501    # IB-815
  - 1.3.6.1.4.1.7779.1.1502    # IB-825
  - 1.3.6.1.4.1.7779.1.1503    # IB-1415
  - 1.3.6.1.4.1.7779.1.1504    # IB-1425
  - 1.3.6.1.4.1.7779.1.1505    # IB-1405
  - 1.3.6.1.4.1.7779.1.1506    # IB-805
  - 1.3.6.1.4.1.7779.1.1507    # PT-1405
  - 1.3.6.1.4.1.7779.1.1511    # IB-2205
  - 1.3.6.1.4.1.7779.1.1512    # IB-2215
  - 1.3.6.1.4.1.7779.1.1513    # IB-2225
  - 1.3.6.1.4.1.7779.1.1514    # PT-2205
  - 1.3.6.1.4.1.7779.1.1521    # IB-4015
  - 1.3.6.1.4.1.7779.1.1522    # IB-4035
  - 1.3.6.1.4.1.7779.1.1523    # IB-4005
  - 1.3.6.1.4.1.7779.1.1524    # PT-4005
  - 1.3.6.1.4.1.7779.1.1525    # IB-4025
  - 1.3.6.1.4.1.7779.1.1541    # ND-805
  - 1.3.6.1.4.1.7779.1.1542    # ND-1405
  - 1.3.6.1.4.1.7779.1.1543    # ND-2205
  - 1.3.6.1.4.1.7779.1.1544    # ND-4005
  - 1.3.6.1.4.1.7779.2.2       # IB-1050
  - 1.3.6.1.4.1.7779.2.4       # IB-1552
  - 1.3.6.1.4.1.7779.3.4       # IB-1552-A
  - 1.3.6.1.4.1.7779.3.7       # IB-2000-A

metrics:
  # Platform Metrics - System Status and Performance
  - MIB: IB-PLATFORMONE-MIB
    symbol:
      name: ibSystemStatus
      OID: 1.3.6.1.4.1.7779.3.1.1.2.1.3.1.1.0
      poll_time_sec: 60
      tag: SystemStatus
  # Platform Metrics - Service Status Counters
  - MIB: IB-PLATFORMONE-MIB
    symbol:
      name: ibServiceStatusCounter1
      OID: 1.3.6.1.4.1.7779.3.1.1.2.1.3.1.4.1.6.0
      poll_time_sec: 60
      tag: ServiceStatusCounter1
  - MIB: IB-PLATFORMONE-MIB
    symbol:
      name: ibServiceStatusCounter2
      OID: 1.3.6.1.4.1.7779.3.1.1.2.1.3.1.4.2.6.0
      poll_time_sec: 60
      tag: ServiceStatusCounter2
  - MIB: IB-PLATFORMONE-MIB
    symbol:
      name: ibServiceStatusCounter3
      OID: 1.3.6.1.4.1.7779.3.1.1.2.1.3.1.4.3.0
      poll_time_sec: 60
      tag: ServiceStatusCounter3
  - MIB: IB-PLATFORMONE-MIB
    symbol:
      name: ibServiceStatusCounter4
      OID: 1.3.6.1.4.1.7779.3.1.1.2.1.3.1.4.4.0
      poll_time_sec: 60
      tag: ServiceStatusCounter4
  - MIB: IB-PLATFORMONE-MIB
    symbol:
      name: ibServiceStatusCounter5
      OID: 1.3.6.1.4.1.7779.3.1.1.2.1.3.1.4.5.0
      poll_time_sec: 60
      tag: ServiceStatusCounter5
  # The size of deferred dynamic DNS update queue
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpDeferredQueueSize
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.4.0
  # A table of named ZONE statistics
  - MIB: IB-DNSONE-MIB
    table:
      name: ibZoneStatisticsTable
      OID: 1.3.6.1.4.1.7779.3.1.1.3.1.1
    symbols:
      # Number of Successful responses since DNS process started.
      - name: ibBindZoneSuccess
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.1.1.2
      # Number of DNS referrals since DNS process started.
      - name: ibBindZoneReferral
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.1.1.3
      # Number of DNS query received for non-existent record.
      - name: ibBindZoneNxRRset
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.1.1.4
      # Number of DNS query received for non-existent domain.
      - name: ibBindZoneNxDomain
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.1.1.5
      # Number of Queries received using recursion since DNS process started.
      - name: ibBindZoneRecursion
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.1.1.6
      # Number of Failed queries since DNS process started.
      - name: ibBindZoneFailure
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.1.1.7
    metric_tags:
      # DNS Zone name. The first one is global summary statistics. Index name for global statistics is 'summary'. All zones live in the default view.
      - column:
          name: ibBindZoneName
          OID: 1.3.6.1.4.1.7779.3.1.1.3.1.1.1.1
  # Number of successful dynamic DNS update.
  - MIB: IB-DNSONE-MIB
    symbol:
      name: ibDDNSUpdateSuccess
      OID: 1.3.6.1.4.1.7779.3.1.1.3.1.3.1.0
  # Number of failure dynamic DNS update.
  - MIB: IB-DNSONE-MIB
    symbol:
      name: ibDDNSUpdateFailure
      OID: 1.3.6.1.4.1.7779.3.1.1.3.1.3.2.0
  # Number of dynamic DNS update rejects maybe due to permission failure.
  - MIB: IB-DNSONE-MIB
    symbol:
      name: ibDDNSUpdateReject
      OID: 1.3.6.1.4.1.7779.3.1.1.3.1.3.3.0
  # Number of dynamic DNS update rejects due to prerequisite failure.
  - MIB: IB-DNSONE-MIB
    symbol:
      name: ibDDNSUpdatePrerequisiteReject
      OID: 1.3.6.1.4.1.7779.3.1.1.3.1.3.4.0
  # DHCP Subnet Table - includes the specific OID .1.3.6.1.4.1.7779.3.1.1.4.1.1.1.3
  - MIB: IB-DHCPONE-MIB
    table:
      name: ibDHCPSubnetTable
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.1
    symbols:
      # DHCP Subnet Network Address
      - name: ibDHCPSubnetNetworkAddress
        OID: 1.3.6.1.4.1.7779.3.1.1.4.1.1.1.1
      # DHCP Subnet Network Mask
      - name: ibDHCPSubnetNetworkMask
        OID: 1.3.6.1.4.1.7779.3.1.1.4.1.1.1.2
      # DHCP Subnet Percent Used - This is the specific OID requested
      - name: ibDHCPSubnetPercentUsed
        OID: 1.3.6.1.4.1.7779.3.1.1.4.1.1.1.3
        poll_time_sec: 60
        tag: DhcpSubnetPercentUsed
    metric_tags:
      # Network address as tag for identification
      - tag: subnet_network
        column:
          name: ibDHCPSubnetNetworkAddress
          OID: 1.3.6.1.4.1.7779.3.1.1.4.1.1.1.1
      # Network mask as tag for identification
      - tag: subnet_mask
        column:
          name: ibDHCPSubnetNetworkMask
          OID: 1.3.6.1.4.1.7779.3.1.1.4.1.1.1.2
  # DHCP Statistics - Total counters for various DHCP operations
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfDiscovers
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.1.0
      poll_time_sec: 60
      tag: DhcpDiscovers
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfRequests
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.2.0
      poll_time_sec: 60
      tag: DhcpRequests
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfReleases
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.3.0
      poll_time_sec: 60
      tag: DhcpReleases
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfOffers
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.4.0
      poll_time_sec: 60
      tag: DhcpOffers
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfAcks
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.5.0
      poll_time_sec: 60
      tag: DhcpAcks
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfNacks
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.6.0
      poll_time_sec: 60
      tag: DhcpNacks
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfDeclines
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.7.0
      poll_time_sec: 60
      tag: DhcpDeclines
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfInforms
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.8.0
      poll_time_sec: 60
      tag: DhcpInforms
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpTotalNoOfOthers
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.3.9.0
      poll_time_sec: 60
      tag: DhcpOthers
  # Additional DHCP Statistics - Extended counters
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter1
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.1.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter1
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter2
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.2.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter2
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter3
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.3.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter3
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter4
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.4.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter4
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter5
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.5.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter5
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter6
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.6.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter6
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter7
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.7.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter7
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter8
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.8.0.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter8
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter9
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.9.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter9
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpExtendedCounter10
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.3.10.0
      poll_time_sec: 60
      tag: DhcpExtendedCounter10
  # Additional DHCP Statistics - Performance metrics
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpPerformanceCounter1
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.5.1.0
      poll_time_sec: 60
      tag: DhcpPerformanceCounter1
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpPerformanceCounter2
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.5.2.0
      poll_time_sec: 60
      tag: DhcpPerformanceCounter2
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpPerformanceCounter3
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.5.3.0
      poll_time_sec: 60
      tag: DhcpPerformanceCounter3
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpPerformanceCounter4
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.5.4.0
      poll_time_sec: 60
      tag: DhcpPerformanceCounter4
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpPerformanceGauge1
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.5.5.0
      poll_time_sec: 60
      tag: DhcpPerformanceGauge1
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpPerformanceGauge2
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.5.6.0
      poll_time_sec: 60
      tag: DhcpPerformanceGauge2
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpPerformanceGauge3
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.5.7.0
      poll_time_sec: 60
      tag: DhcpPerformanceGauge3
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDhcpPerformanceGauge4
      OID: 1.3.6.1.4.1.7779.3.1.1.4.2.5.8.0
      poll_time_sec: 60
      tag: DhcpPerformanceGauge4
  # DHCP DDNS Statistics - Average latency metrics
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDHCPDDNSAvgLatency5
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.5.1.0
      poll_time_sec: 60
      tag: DhcpDdnsLatency5min
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDHCPDDNSAvgLatency15
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.5.2.0
      poll_time_sec: 60
      tag: DhcpDdnsLatency15min
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDHCPDDNSAvgLatency60
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.5.3.0
      poll_time_sec: 60
      tag: DhcpDdnsLatency60min
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDHCPDDNSAvgLatency1440
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.5.4.0
      poll_time_sec: 60
      tag: DhcpDdnsLatency1440min
  # DHCP DDNS Timeout Counts
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDHCPDDNSTimeoutCount5
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.5.5.0
      poll_time_sec: 60
      tag: DhcpDdnsTimeout5min
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDHCPDDNSTimeoutCount15
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.5.6.0
      poll_time_sec: 60
      tag: DhcpDdnsTimeout15min
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDHCPDDNSTimeoutCount60
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.5.7.0
      poll_time_sec: 60
      tag: DhcpDdnsTimeout60min
  - MIB: IB-DHCPONE-MIB
    symbol:
      name: ibDHCPDDNSTimeoutCount1440
      OID: 1.3.6.1.4.1.7779.3.1.1.4.1.5.8.0
      poll_time_sec: 60
      tag: DhcpDdnsTimeout1440min
  # DNS queries per second
  - MIB: IB-DNSONE-MIB
    symbol:
      name: ibDnsQueryRate
      OID: 1.3.6.1.4.1.7779.3.1.1.3.1.6.0
  # Zone Transfer Count Statistics
  - MIB: IB-DNSONE-MIB
    symbol:
      name: ibBindZoneTransferCount
      OID: 1.3.6.1.4.1.7779.3.1.1.3.1.4.0
      poll_time_sec: 60
      tag: DnsZoneTransferCount
  # Zone Plus View Statistics Table - Statistics per zone and view
  - MIB: IB-DNSONE-MIB
    table:
      name: ibZonePlusViewStatisticsTable
      OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2
    symbols:
      # Zone Plus View Success count
      - name: ibBindZonePlusViewSuccess
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2.1.2
        poll_time_sec: 60
        tag: DnsZonePlusViewSuccess
      # Zone Plus View Referral count
      - name: ibBindZonePlusViewReferral
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2.1.3
        poll_time_sec: 60
        tag: DnsZonePlusViewReferral
      # Zone Plus View NXRRset count
      - name: ibBindZonePlusViewNxRRset
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2.1.4
        poll_time_sec: 60
        tag: DnsZonePlusViewNxRRset
      # Zone Plus View NXDomain count
      - name: ibBindZonePlusViewNxDomain
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2.1.5
        poll_time_sec: 60
        tag: DnsZonePlusViewNxDomain
      # Zone Plus View Recursion count
      - name: ibBindZonePlusViewRecursion
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2.1.6
        poll_time_sec: 60
        tag: DnsZonePlusViewRecursion
      # Zone Plus View Failure count
      - name: ibBindZonePlusViewFailure
        OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2.1.7
        poll_time_sec: 60
        tag: DnsZonePlusViewFailure
    metric_tags:
      # Zone Plus View Name
      - tag: zone_plus_view_name
        column:
          name: ibBindZonePlusViewName
          OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2.1.1
      # Bind View Name
      - tag: bind_view_name
        column:
          name: ibBindViewName
          OID: 1.3.6.1.4.1.7779.3.1.1.3.1.2.1.8

metric_tags:
